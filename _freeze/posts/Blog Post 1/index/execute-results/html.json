{
  "hash": "760b97a9a5b9a7cb25f6cc0cc2c94607",
  "result": {
    "markdown": "---\ntitle: \"Probability Theory and Random Variables\"\nauthor: \"Rithvik Guntor\"\ndate: \"2023-11-1\"\ncategories: \n  - code\n  - analysis\n---\n\nProbability Theory and Random Variables are an important component of statistical analysis in various studies. Probability theory serves as a framework for quantifying the likelihood of various outcomes in many statistical problems. In particular, probability theory and random variables have proven invaluable in the domain of breast cancer research. They enable researchers to model and analyze complex data, and facilitate a deeper understanding of the disease's prevalence, risk factors, and treatment outcomes, ultimately contributing to more effective diagnosis and treatment strategies. It's application and connection in breast cancer research allows us to better understand uncertainty in breast cancer cases as well as many other real-world applications. The below code provides a closer look at probability theory and random variable study using a breast cancer dataset. \n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\n# Import necessary libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom scipy.stats import norm, lognorm\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.mixture import GaussianMixture\n```\n:::\n\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\n# Load your breast cancer dataset\ndata = pd.read_csv('Breast_Cancer.csv')\ndata.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Race</th>\n      <th>Marital Status</th>\n      <th>T Stage</th>\n      <th>N Stage</th>\n      <th>6th Stage</th>\n      <th>differentiate</th>\n      <th>Grade</th>\n      <th>A Stage</th>\n      <th>Tumor Size</th>\n      <th>Estrogen Status</th>\n      <th>Progesterone Status</th>\n      <th>Regional Node Examined</th>\n      <th>Reginol Node Positive</th>\n      <th>Survival Months</th>\n      <th>Status</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>68</td>\n      <td>White</td>\n      <td>Married</td>\n      <td>T1</td>\n      <td>N1</td>\n      <td>IIA</td>\n      <td>Poorly differentiated</td>\n      <td>3</td>\n      <td>Regional</td>\n      <td>4</td>\n      <td>Positive</td>\n      <td>Positive</td>\n      <td>24</td>\n      <td>1</td>\n      <td>60</td>\n      <td>Alive</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>50</td>\n      <td>White</td>\n      <td>Married</td>\n      <td>T2</td>\n      <td>N2</td>\n      <td>IIIA</td>\n      <td>Moderately differentiated</td>\n      <td>2</td>\n      <td>Regional</td>\n      <td>35</td>\n      <td>Positive</td>\n      <td>Positive</td>\n      <td>14</td>\n      <td>5</td>\n      <td>62</td>\n      <td>Alive</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>58</td>\n      <td>White</td>\n      <td>Divorced</td>\n      <td>T3</td>\n      <td>N3</td>\n      <td>IIIC</td>\n      <td>Moderately differentiated</td>\n      <td>2</td>\n      <td>Regional</td>\n      <td>63</td>\n      <td>Positive</td>\n      <td>Positive</td>\n      <td>14</td>\n      <td>7</td>\n      <td>75</td>\n      <td>Alive</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>58</td>\n      <td>White</td>\n      <td>Married</td>\n      <td>T1</td>\n      <td>N1</td>\n      <td>IIA</td>\n      <td>Poorly differentiated</td>\n      <td>3</td>\n      <td>Regional</td>\n      <td>18</td>\n      <td>Positive</td>\n      <td>Positive</td>\n      <td>2</td>\n      <td>1</td>\n      <td>84</td>\n      <td>Alive</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>47</td>\n      <td>White</td>\n      <td>Married</td>\n      <td>T2</td>\n      <td>N1</td>\n      <td>IIB</td>\n      <td>Poorly differentiated</td>\n      <td>3</td>\n      <td>Regional</td>\n      <td>41</td>\n      <td>Positive</td>\n      <td>Positive</td>\n      <td>3</td>\n      <td>1</td>\n      <td>50</td>\n      <td>Alive</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nWe specifically want to examine the patient age and tumor size varibales for this study. \n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\n# Select the relevant features: Age and Tumor Size\nX = data[['Age', 'Tumor Size']]\nX\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Tumor Size</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>68</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>50</td>\n      <td>35</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>58</td>\n      <td>63</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>58</td>\n      <td>18</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>47</td>\n      <td>41</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>4019</th>\n      <td>62</td>\n      <td>9</td>\n    </tr>\n    <tr>\n      <th>4020</th>\n      <td>56</td>\n      <td>46</td>\n    </tr>\n    <tr>\n      <th>4021</th>\n      <td>68</td>\n      <td>22</td>\n    </tr>\n    <tr>\n      <th>4022</th>\n      <td>58</td>\n      <td>44</td>\n    </tr>\n    <tr>\n      <th>4023</th>\n      <td>46</td>\n      <td>30</td>\n    </tr>\n  </tbody>\n</table>\n<p>4024 rows Ã— 2 columns</p>\n</div>\n```\n:::\n:::\n\n\nWe standardize the data to mitigate the effect of outliers and simplify interpretability.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\n# Step 1: Standardize the data\nscaler = StandardScaler()\nX_std = scaler.fit_transform(X)\n```\n:::\n\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\n# Compute mean/standard deviation for the standardized data\nfor feature in ['Age', 'Tumor Size']:\n    mean = X_std[:, X.columns.get_loc(feature)].mean()\n    std = X_std[:, X.columns.get_loc(feature)].std()\n    print(f\"{feature}: Mean = {mean}, Standard Deviation = {std}\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAge: Mean = -4.855846230964899e-17, Standard Deviation = 1.0\nTumor Size: Mean = 5.120710570835712e-17, Standard Deviation = 1.0\n```\n:::\n:::\n\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\n# Plot Histograms and Fit Gaussian Distributions\nplt.figure(figsize=(12, 5))\nfor i, feature in enumerate(['Age', 'Tumor Size'], start=1):\n    plt.subplot(1, 2, i)\n    plt.hist(X_std[:, X.columns.get_loc(feature)], bins=20, density=True, alpha=0.6, color='b', label=feature)\n    x = np.linspace(X_std[:, X.columns.get_loc(feature)].min(), X_std[:, X.columns.get_loc(feature)].max(), 100)\n    \n    # Fit a Gaussian (Normal) distribution\n    mu, std = norm.fit(X_std[:, X.columns.get_loc(feature)])\n    p = norm.pdf(x, mu, std)\n    plt.plot(x, p, 'k', linewidth=2, label=f'Normal Fit:\\n$\\mu$={mu:.2f}, $\\sigma$={std:.2f}')\n    \n    plt.xlabel(feature + ' (Standardized)')\n    plt.ylabel('Probability')\n    plt.legend()\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-7-output-1.png){width=1141 height=468}\n:::\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\n# Calculate mean for Age and Tumor Size\nmeans = X.mean()\nmeans\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\nAge           53.972167\nTumor Size    30.473658\ndtype: float64\n```\n:::\n:::\n\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\n# Calculate variance Age and Tumor Size\nvariances = X.var()\nvariances\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\nAge            80.337778\nTumor Size    446.041563\ndtype: float64\n```\n:::\n:::\n\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\n# Calculate covariance matrix for Age and Tumor Size\ncovariance_matrix = X.cov()\ncovariance_matrix\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Age</th>\n      <th>Tumor Size</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>Age</th>\n      <td>80.337778</td>\n      <td>-14.616692</td>\n    </tr>\n    <tr>\n      <th>Tumor Size</th>\n      <td>-14.616692</td>\n      <td>446.041563</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThe results above show that the age variable has a higher mean than the tumor size variable. However, it is interesting that the tumor size appears to have a significantly larger variance compared to the age. It can be seen from the visualizations above that we have fitted normal Gaussian distributions. The standardized tumor size histogram/curve appear to be slightly skewed to the right compared to the standardized age histogram/curve. Though the tumor size histogram is standardized, the shape of the curve may be a result of the significant variance in the tumor size variable.  \n\n**Gaussian Mixture Model**\n\nAnother technique that is often applicable to probability theory and random variable studies is the Gaussian Mixture Model method. This method is used to represent complex variable distributions. It can also be used in anomaly/outlier detection as well (see the anomaly/outlier detection post). GMMs are used to estimate the probability density of a continuous random variable. They represent the probability distribution as a weighted sum of multiple Gaussian distributions. The GMM can provide a more flexible representation of complex data distributions as opposed to a single Gaussian distribution. The code below explores the variables from the same dataset using the GMM technique.\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\n# Use the Gaussian Mixture Model Approach\ngm = GaussianMixture(n_components=3, n_init=10, random_state=42)\ngm.fit(X)\n```\n\n::: {.cell-output .cell-output-display execution_count=10}\n```\nGaussianMixture(n_components=3, n_init=10, random_state=42)\n```\n:::\n:::\n\n\n::: {.cell execution_count=11}\n``` {.python .cell-code}\n# Computes the weights\ngm.weights_\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\narray([0.58662902, 0.13513493, 0.27823604])\n```\n:::\n:::\n\n\n::: {.cell execution_count=12}\n``` {.python .cell-code}\n# Computes the means\ngm.means_\n```\n\n::: {.cell-output .cell-output-display execution_count=12}\n```\narray([[54.8125781 , 18.22267396],\n       [52.17021474, 69.50342509],\n       [53.07543614, 37.34731049]])\n```\n:::\n:::\n\n\n::: {.cell execution_count=13}\n``` {.python .cell-code}\n# Computes the covariances\ngm.covariances_\n```\n\n::: {.cell-output .cell-output-display execution_count=13}\n```\narray([[[ 76.68503418,  -1.77744933],\n        [ -1.77744933,  45.93142242]],\n\n       [[ 85.62276729,   4.36998368],\n        [  4.36998368, 555.47154068]],\n\n       [[ 81.53029285,  11.13430287],\n        [ 11.13430287, 132.53955524]]])\n```\n:::\n:::\n\n\n::: {.cell execution_count=14}\n``` {.python .cell-code}\n# Checks if algorithm converged\ngm.converged_\n```\n\n::: {.cell-output .cell-output-display execution_count=14}\n```\nTrue\n```\n:::\n:::\n\n\n::: {.cell execution_count=15}\n``` {.python .cell-code}\n# Checks the number of iterations algorithm took to converge\ngm.n_iter_\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```\n6\n```\n:::\n:::\n\n\n::: {.cell execution_count=16}\n``` {.python .cell-code}\n# Predicts which cluster each instance belongs to\ngm.predict(X)\n```\n\n::: {.cell-output .cell-output-display execution_count=16}\n```\narray([0, 2, 1, ..., 0, 2, 2])\n```\n:::\n:::\n\n\n::: {.cell execution_count=17}\n``` {.python .cell-code}\n# Predicts probabilities that instance came from cluster\ngm.predict_proba(X).round(3)\n```\n\n::: {.cell-output .cell-output-display execution_count=17}\n```\narray([[0.978, 0.007, 0.015],\n       [0.132, 0.067, 0.802],\n       [0.   , 0.695, 0.305],\n       ...,\n       [0.919, 0.006, 0.075],\n       [0.003, 0.121, 0.876],\n       [0.432, 0.039, 0.529]])\n```\n:::\n:::\n\n\n::: {.cell execution_count=18}\n``` {.python .cell-code}\n# Estimate the log of the PDF at any location \ngm.score_samples(X).round(2)\n```\n\n::: {.cell-output .cell-output-display execution_count=18}\n```\narray([-9.68, -7.61, -9.1 , ..., -7.69, -7.91, -7.58])\n```\n:::\n:::\n\n\nThe code above uses the Gaussian Mixed Model method to estimate the logarithm of the probability density function of the data points in the variable 'X'. The GMM approach is a powerful tool in probability theory and random variable studies. It's applications in real-world situations like breast cancer studies make it invaluable throughout the industry and research. GMM enables us to model various data distributions to gain a better understanding of probability distribution functions, anomaly detection, and random variables as a whole. This versatile tool continues to allow statisticians and researchers to capture various components of complex data distributions.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}